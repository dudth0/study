# 배너 베리에이션 Planning Document

> **Summary**: 글자수 제한에 맞춰 홍보카피를 자동으로 요약/변환하는 기능
>
> **Project**: core
> **Version**: 0.0.1-SNAPSHOT
> **Author**: Developer
> **Date**: 2026-02-08
> **Status**: Draft

---

## 1. Overview

### 1.1 Purpose

하나의 홍보 카피를 다양한 글자수 제한(10자, 20자, 50자, 100자 등)에 맞게 자동으로 요약/변환하고, 각 베리에이션에 최적화된 배너 이미지를 자동으로 생성하여, 여러 마케팅 채널에 즉시 사용 가능한 컨텐츠를 빠르게 생성할 수 있도록 합니다.

### 1.2 Background

각 마케팅 채널(트위터, 페이스북, 인스타그램, 배너 광고 등)마다 글자수 제한과 이미지 규격이 다릅니다. 마케터가 수동으로 각 채널에 맞게 카피를 수정하고 디자이너가 각 버전의 배너 이미지를 제작하는 것은 시간이 많이 걸리고 일관성 유지가 어렵습니다. AI 기반 자동 요약 및 이미지 생성 기능을 통해 이 과정을 자동화하고 생산성을 획기적으로 향상시킬 필요가 있습니다.

### 1.3 Related Documents

- Requirements: 내부 마케팅 팀 요청사항
- References: 주요 플랫폼 글자수 제한 가이드

---

## 2. Scope

### 2.1 In Scope

- [ ] 원본 홍보 카피 입력 및 저장
- [ ] 글자수 제한 설정 (10자, 20자, 50자, 100자 등)
- [ ] AI 기반 자동 요약/변환 기능
- [ ] 요약된 카피에 맞는 배너 이미지 자동 생성
- [ ] 이미지 사이즈 옵션 (소셜 미디어 규격별: 정사각형, 가로형, 세로형)
- [ ] 변환된 베리에이션 및 이미지 목록 조회
- [ ] 자동 생성된 카피 수동 편집 기능
- [ ] 이미지 재생성 기능
- [ ] 베리에이션 히스토리 관리

### 2.2 Out of Scope

- 다국어 번역 기능 (2단계 기능)
- 실시간 성과 분석 (A/B 테스트)
- 고급 이미지 편집 기능 (레이어, 필터, 복잡한 합성)
- 동영상 생성 기능

---

## 3. Requirements

### 3.1 Functional Requirements

| ID | Requirement | Priority | Status |
|----|-------------|----------|--------|
| FR-01 | 사용자는 원본 홍보 카피를 입력하고 저장할 수 있어야 함 | High | Pending |
| FR-02 | 다양한 글자수 제한(10자, 20자, 50자, 100자)을 선택할 수 있어야 함 | High | Pending |
| FR-03 | 선택한 글자수 제한에 맞게 자동으로 요약된 베리에이션 생성 | High | Pending |
| FR-04 | 각 베리에이션에 맞는 배너 이미지를 AI로 자동 생성 | High | Pending |
| FR-05 | 이미지 사이즈 옵션 선택 (1:1, 16:9, 9:16 등) | High | Pending |
| FR-06 | 생성된 베리에이션 및 이미지를 미리보기로 확인 가능 | High | Pending |
| FR-07 | 자동 생성된 카피를 수동으로 편집 가능 | Medium | Pending |
| FR-08 | 배너 이미지 재생성 기능 (다른 스타일/컨셉으로) | Medium | Pending |
| FR-09 | 원본 및 베리에이션 히스토리 조회 가능 | Medium | Pending |
| FR-10 | 베리에이션 삭제 및 재생성 기능 | Low | Pending |

### 3.2 Non-Functional Requirements

| Category | Criteria | Measurement Method |
|----------|----------|-------------------|
| Performance | 요약 생성 응답 시간 < 3초 | JMeter 부하 테스트 |
| Performance | 이미지 생성 응답 시간 < 10초 | JMeter 부하 테스트 |
| Quality | 요약 품질 평가 점수 > 4.0/5.0 | 사용자 피드백 수집 |
| Quality | 이미지 품질 평가 점수 > 4.0/5.0 | 사용자 피드백 수집 |
| Security | 인증된 사용자만 기능 접근 가능 | Spring Security 권한 검증 |
| Scalability | 동시 요청 100건 처리 가능 | 부하 테스트 |
| Storage | 생성된 이미지 파일 관리 (S3 또는 로컬) | 스토리지 용량 모니터링 |

---

## 4. Success Criteria

### 4.1 Definition of Done

- [ ] 모든 기능 요구사항 구현 완료
- [ ] 단위 테스트 작성 및 통과 (coverage > 80%)
- [ ] 코드 리뷰 완료
- [ ] API 문서 작성 완료

### 4.2 Quality Criteria

- [ ] 테스트 커버리지 80% 이상
- [ ] Checkstyle 오류 없음
- [ ] 빌드 성공

---

## 5. Risks and Mitigation

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| AI 요약 품질이 기대에 미치지 못할 수 있음 | High | Medium | 수동 편집 기능 제공, 다양한 알고리즘 테스트 |
| 이미지 생성 품질이 낮거나 부적절할 수 있음 | High | Medium | 재생성 기능 제공, 프롬프트 엔지니어링 개선 |
| 외부 AI API 비용 및 응답 시간 문제 | High | Medium | 캐싱 전략, 대체 알고리즘 준비 |
| 이미지 생성 비용이 예상보다 높을 수 있음 | High | Medium | 이미지 캐싱, 생성 횟수 제한, 비용 모니터링 |
| 특수한 전문용어나 브랜드명 처리 오류 | Medium | High | 사용자 정의 키워드 보존 기능 추가 |
| API 호출 실패 시 서비스 중단 | Medium | Low | 재시도 로직 및 Fallback 메커니즘 구현 |
| 이미지 저장 공간 부족 | Medium | Medium | S3 스토리지 사용, 오래된 이미지 자동 삭제 정책 |

---

## 6. Architecture Considerations

### 6.1 Project Level Selection

| Level | Characteristics | Recommended For | Selected |
|-------|-----------------|-----------------|:--------:|
| **Starter** | Simple structure (`components/`, `lib/`, `types/`) | Static sites, portfolios, landing pages | ☐ |
| **Dynamic** | Feature-based modules, BaaS integration (bkend.ai) | Web apps with backend, SaaS MVPs, fullstack apps | ☐ |
| **Enterprise** | Strict layer separation, DI, microservices | High-traffic systems, complex architectures | ☑ |

**선택 이유**: Spring Boot 기반의 엔터프라이즈 아키텍처 프로젝트

### 6.2 Key Architectural Decisions

| Decision | Options | Selected | Rationale |
|----------|---------|----------|-----------|
| Framework | Spring Boot / Spring MVC | Spring Boot | 현재 프로젝트 기반 |
| Database | MySQL / PostgreSQL / H2 | H2 (개발), MySQL (프로덕션) | 빠른 개발 및 프로덕션 대응 |
| ORM | JPA / MyBatis / JDBC Template | Spring Data JPA | 생산성 및 유지보수성 |
| AI/NLP API | OpenAI / Claude API / 자체 알고리즘 | OpenAI (1차), 자체 (Fallback) | 품질과 비용 고려, 대체 방안 확보 |
| Image Generation API | DALL-E 3 / Stable Diffusion / Midjourney API | DALL-E 3 (OpenAI) | OpenAI 통합 사용, 안정성 및 품질 |
| Image Storage | AWS S3 / Local Storage / Cloud Storage | AWS S3 (프로덕션), Local (개발) | 확장성 및 CDN 연동 용이 |
| Text Processing | Apache OpenNLP / Stanford NLP | 자체 구현 + OpenAI | 단순성 및 품질 우선 |
| Caching | Redis / Caffeine / EhCache | Caffeine | API 호출 최소화를 위한 캐싱 |
| Testing | JUnit 5 / TestNG | JUnit 5 | Spring Boot 기본 지원 |

### 6.3 Clean Architecture Approach

```
Selected Level: Enterprise

Folder Structure Preview:
┌─────────────────────────────────────────────────────────┐
│ src/main/java/hello/core/                               │
│   ├── domain/                   (도메인 엔티티)         │
│   │   └── copy/                                         │
│   │       ├── Copy.java         (카피 엔티티)           │
│   │       ├── CopyVariation.java (베리에이션)          │
│   │       └── BannerImage.java  (배너 이미지)          │
│   ├── application/              (비즈니스 로직)         │
│   │   └── copy/                                         │
│   │       ├── CopyService.java                          │
│   │       ├── SummarizerService.java (요약 서비스)     │
│   │       ├── ImageGenerationService.java (이미지생성) │
│   │       └── dto/                                      │
│   ├── infrastructure/           (외부 연동)             │
│   │   └── copy/                                         │
│   │       ├── CopyRepository.java                       │
│   │       ├── BannerImageRepository.java                │
│   │       ├── ai/                                       │
│   │       │   ├── OpenAIClient.java (텍스트 AI)        │
│   │       │   ├── DallEClient.java (이미지 AI)         │
│   │       │   └── FallbackSummarizer.java               │
│   │       └── storage/                                  │
│   │           └── S3StorageService.java (이미지 저장)  │
│   └── presentation/             (컨트롤러)              │
│       └── copy/                                         │
│           └── CopyController.java                       │
└─────────────────────────────────────────────────────────┘
```

---

## 7. Convention Prerequisites

### 7.1 Existing Project Conventions

Check which conventions already exist in the project:

- [ ] `CLAUDE.md` has coding conventions section
- [ ] `docs/01-plan/conventions.md` exists (Phase 2 output)
- [ ] `CONVENTIONS.md` exists at project root
- [ ] Checkstyle configuration (`checkstyle.xml`)
- [ ] Gradle configuration (`build.gradle`)

### 7.2 Conventions to Define/Verify

| Category | Current State | To Define | Priority |
|----------|---------------|-----------|:--------:|
| **Naming** | 확인 필요 | Java 네이밍 컨벤션 (camelCase, PascalCase) | High |
| **Folder structure** | 기본 구조 존재 | 계층별 패키지 구조 명확화 | High |
| **Import order** | 확인 필요 | 표준 import 순서 정의 | Medium |
| **Exception handling** | 확인 필요 | 예외 처리 패턴 정의 | High |
| **Logging** | 확인 필요 | 로깅 레벨 및 포맷 정의 | Medium |

### 7.3 Environment Variables Needed

| Variable | Purpose | Scope | To Be Created |
|----------|---------|-------|:-------------:|
| `SPRING_DATASOURCE_URL` | 데이터베이스 연결 | Server | ☑ |
| `SPRING_DATASOURCE_USERNAME` | DB 사용자명 | Server | ☑ |
| `SPRING_DATASOURCE_PASSWORD` | DB 비밀번호 | Server | ☑ |
| `OPENAI_API_KEY` | OpenAI API 인증 키 (텍스트 + 이미지) | Server | ☐ |
| `OPENAI_TEXT_MODEL` | 텍스트 모델 (예: gpt-4) | Server | ☐ |
| `OPENAI_IMAGE_MODEL` | 이미지 모델 (예: dall-e-3) | Server | ☐ |
| `AI_SUMMARIZER_TIMEOUT` | AI API 타임아웃 (ms) | Server | ☐ |
| `AWS_S3_BUCKET_NAME` | S3 버킷명 (이미지 저장) | Server | ☐ |
| `AWS_ACCESS_KEY_ID` | AWS 액세스 키 | Server | ☐ |
| `AWS_SECRET_ACCESS_KEY` | AWS 시크릿 키 | Server | ☐ |
| `AWS_REGION` | AWS 리전 (예: ap-northeast-2) | Server | ☐ |

### 7.4 Pipeline Integration

If using 9-phase Development Pipeline, check the following:

| Phase | Status | Document Location | Command |
|-------|:------:|-------------------|---------|
| Phase 1 (Schema) | ☐ | `docs/01-plan/schema.md` | `/pipeline-next` |
| Phase 2 (Convention) | ☐ | `docs/01-plan/conventions.md` | `/pipeline-next` |

---

## 8. Next Steps

1. [ ] Write design document (`배너-베리에이션.design.md`)
2. [ ] Team review and approval
3. [ ] Start implementation

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 0.1 | 2026-02-08 | Initial draft | Developer |
| 0.2 | 2026-02-08 | 핵심 기능 변경: 글자수 제한에 맞춘 홍보카피 자동 요약/변환 | Developer |
| 0.3 | 2026-02-21 | 배너 이미지 자동 생성 기능 추가 (DALL-E 3 연동, S3 저장) | Developer |
